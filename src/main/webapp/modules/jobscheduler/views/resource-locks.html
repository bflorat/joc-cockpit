<div class="hide-block sidebar-btn resize-cursor">
    <i class="fa fa-angle-double-right p-l-sm" ng-click="showLeftPanel()"></i>
</div>
 <div id="leftPanel" class="leftPanel" resizable r-directions="['right']" r-width="270">
     <div>
         <button class="btn btn-grey btn-sm" ng-click="my_tree_lock.expand_all();" >
             <i class="fa fa-angle-down fa-lg"></i>
             <span translate>button.expandAll</span>
         </button>
         <button class="btn btn-grey btn-sm m-l-xs" ng-click="my_tree_lock.collapse_all();" >
             <i class="fa fa-angle-up fa-lg"></i>
             <span translate>button.collapseAll</span>
         </button>
         <a class="text m-l-xs resize-cursor"><i class="fa fa-angle-double-left fa-lg" ng-click="hidePanel()"></i></a>
         <tree tree-data="treeLock"
               tree-control="my_tree_lock"
               expand-on="expanding_property1"
               on-select="treeHandler1L(branch)"
               on-click="treeHandlerL(branch)"
               expand-node="expandNodeL(branch)"
               collapse-node="collapseNodeL(branch)"
               template-url="modules/core/template/tree.html">
         </tree>
     </div>
 </div>
<div id="rightPanel1">
    <div class="hide" ng-class="{'show': isLoading}">
        <div class="hide row m-t-sm" ng-class="{'show': pageView=='grid'}">
            <div ng-repeat="branch in branchsL track by $index">
                <div class="col-sm-12" ng-if="branch.path" style="margin-bottom: 10px">
                    <span class="text inline"><i class="fa fa-folder-o"></i> {{::branch.path}}</span>
                </div>
                <div class="col-xxl-3 col-lg-4 col-md-6 col-sm-12 col-xs-12 hide" ng-class="{'show': pageView=='grid'}" ng-repeat="lock in branch.locks | orderBy: propertyNameL">
                    <div class="box card">
                        <div class="box-body">
                            <div class="text-left block-ellipsis">
                                <span class="text-left">
                                    <i class="fa fa-lock text-sm "></i>
                                    <span ng-bind="lock.name"></span>
                                </span>
                            </div>
                            <div class="btn-group dropdown pull-right abt-dropdown hide"  ng-class="{show:permission.Lock.view.configuration}">
                                <a href class=" more-option text-black-lt" data-toggle="dropdown"><i
                                        class="text fa fa-ellipsis-h"></i></a>
                                <div class="dropdown-menu dropdown-ac dropdown-more">
                                    <a ng-click="showConfiguration('lock',lock.path,lock.name)" class="dropdown-item" translate>button.showConfiguration</a>
                                </div>
                            </div>
                            <div class="text-sm  text-left text-muted p-t-sm" ><span class="text-black _600" ng-bind="lock.maxNonExclusive || '0'"></span> {{'label.maxTask' | translate}}</div>
                            <div class="text-sm  text-left text-muted p-t-xs" ><span class="text-black _600" ng-bind="lock.holders.tasks.length || '0'"></span> {{'label.runningTask' | translate}}</div>
                            <div class="text-sm  text-left text-muted p-t-xs" ><span class="text-black _600" ng-bind="lock.queue.length || '0'"></span> {{'label.waitingTask' | translate}}</div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="m-t-sm box p-a" ng-show="pageView=='list' && allLocks.length>0">
            <div class="table-responsive" >
                <table class="table table-hover table-bordered  ">
                        <thead>
                        <tr>
                            <th ng-click="sortByL('name')"><a><span translate>label.lockName</span>
                                <i ng-show="propertyNameL == 'name' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'name' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortByL('path')"><a><span translate>label.path</span>
                                <i ng-show="propertyNameL == 'path' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'path' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortByL('status')"><a><span translate>label.status</span>
                                <i ng-show="propertyNameL == 'status' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'status' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortByL('maxNonExclusive')"><a><span translate>label.maxNonExclusive</span>
                                <i ng-show="propertyNameL == 'maxNonExclusive' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'maxNonExclusive' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortByL('holders.tasks.length')"><a><span translate>label.numberLockHolder</span>
                                <i ng-show="propertyNameL == 'holders.tasks.length' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'holders.tasks.length' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortByL('queue.length')"><a><span translate>label.numberQueued</span>
                                <i ng-show="propertyNameL == 'queue.length' && !reverseL"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyNameL == 'queue.length' && reverseL"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="lock in filtered = (allLocks | filter: filterString:strict) | orderBy: propertyNameL | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize">
                            <td ng-bind="lock.name || '-'"></td>
                            <td>{{lock.path}}</td>
                            <td ng-bind="lock.status || '-'"></td>
                            <td ng-bind="lock.maxNonExclusive || '0'"></td>
                            <td ng-bind="lock.holders.tasks.length || '0'"></td>
                            <td ng-bind="lock.queue.length || '0'"></td>
                            <td class="hide"  ng-class="{show:permission.Lock.view.configuration}">
                                <div class="btn-group dropdown">
                                        <button type="button" class="btn-drop more-option-h" data-toggle="dropdown">
                                            <i class="fa fa-ellipsis-h"></i></button>
                                        <div class="dropdown-menu dropdown-ac dropdown-more pull-left m-r-28" role="menu">
                                            <a ng-click="showConfiguration('lock',lock.path,lock.name)"
                                               class="dropdown-item"
                                               translate>button.showConfiguration</a>
                                        </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                <ul ng-show="filtered.length > pageSize" uib-pagination total-items="filtered.length" ng-model="currentPage" items-per-page='pageSize' class="pagination-sm m-t-0" max-size="5" boundary-link-numbers="true" rotate="false" previous-text="Prev"></ul>
                <div class="pull-right" ng-show="filtered.length > 10">
                        <div class="btn-group m-r-xxs">
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'10'"
                                    ng-class="{'primary': pageSize=='10'}" >10
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'25'"
                                    ng-class="{'primary': pageSize=='25'}" >25
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'50'"
                                    ng-class="{'primary': pageSize=='50'}" >50
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'100'"
                                    ng-class="{'primary': pageSize=='100'}">100
                            </button>
                        </div>
                    </div>
                <div class="text-center m-t text-uppercase hide text-orange" ng-class="{'show': (filtered.length===0 && allLocks.length !==0)}" translate>message.noDataMatched</div>
            </div>
        </div>

        <div ng-if="isLoading && !loading && allLocks.length==0" class="text-center m-t h6">
            <span class="text-primary">"{{folderPathL || '/'}}"</span>
            <span translate>message.emptyFolder</span>
        </div>
            <div class="hide text-center m-t-lg text-primary text" ng-class="{'show': loading}">
                <div><i class="fa fa-spinner fa-spin"></i> {{'label.loading' | translate}}...</div>
            </div>
    </div>
    <div ng-if="!isLoading" class="text-center m-t-lg"><div class="cssload-loading">{{'label.loading' | translate}}...</div></div>
</div>

<script>
   $('.table-responsive').on('shown.bs.dropdown', function (e) {
    var $table = $(this),
        $menu = $(e.target).find('.dropdown-menu'),
        tableOffsetHeight = $table.offset().top + $table.height(),
        menuOffsetHeight = $menu.offset().top + $menu.outerHeight(true);

    if (menuOffsetHeight > tableOffsetHeight)
      $table.css("padding-bottom", menuOffsetHeight - tableOffsetHeight +10);
  });

  $('.table-responsive').on('hide.bs.dropdown', function () {
      $(this).css("padding-bottom", 0);
  });
      $(document).ready(function () {
      $('#leftPanel').stickySidebar({
            sidebarTopMargin: 190
        });
  });
</script>
