<div class="white box-shadow sub-header">
    <div class="row">
        <div class="col-md-12">
            <div class="padding">
                <div class="text-right ">
                    <div class="pull-left">
                        <span class="text-md text-orange _600 p-t-xs" ncy-breadcrumb></span>
                    </div>
                    <div class="inline" ng-class="{'hide':object.schedules.length>0}">

                        <div class="btn-group">
                                <button class="btn btn-grey btn-sm" ng-model="filter.state" uib-btn-radio="'all'"
                                        ng-class="{'btn-primary': filter.state=='all'}" ng-click="load()">All <span class="hidden-md-down">Schedules</span>
                                </button>
                                <button class="btn btn-grey btn-sm" ng-model="filter.state"
                                        uib-btn-radio="'active'"
                                        ng-class="{'btn-primary': filter.state=='active'}" ng-click="load()">Active
                                </button>
                                <button class="btn btn-grey btn-sm" ng-model="filter.state"
                                        uib-btn-radio="'stopped'"
                                        ng-class="{'btn-primary': filter.state=='stopped'}" ng-click="load()">Inactive
                                </button>
                        </div>

                        <div class="btn-group dropdown">
                             <a class="btn btn-grey btn-sm m-l-sm" data-toggle="dropdown">Sort By <span class="text-primary">
                                <span ng-show="filter.sortBy =='name'">
                                    Name
                                    <i ng-show="!sortReverse" class="fa fa-caret-down"></i>
                                    <i ng-show="sortReverse" class="fa fa-caret-up"></i>
                                </span>
                                <span ng-show="filter.sortBy =='nextStartTime'">
                                    Next Start
                                    <i ng-show="!sortReverse" class="fa fa-caret-down"></i>
                                    <i ng-show="sortReverse" class="fa fa-caret-up"></i>
                                    </span>
                                </span>
                             </a>
                            <div class="dropdown-menu dropdown-menu-scale dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item" href ng-click="mainSortBy('name')" >Name</a>
                                <a class="dropdown-item" href ng-click="mainSortBy('nextStartTime')">Next Start</a>
                            </div>
                        </div>
                    </div>
                    <div class="hide" ng-class="{'show-block':object.schedules.length>0}">
                        <button class="btn btn-grey btn-sm m-l-sm" ng-click="substituteAll()"><i class="fa fa-repeat"></i> Substitute</button>

                    </div>
                    <toggle-view></toggle-view>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="scroll-y max-ht">
    <div class="padding p-b-0">
        <div class="hide m-t-sm" ng-class="{'show': isLoading}">
            <div class="hide row" ng-class="{'show': pageView=='grid'}">
                <div>
                    <div class="col-xxl-2 col-lg-3 col-md-4 col-sm-6 col-xs-12"  ng-repeat="schedule in filtered = (schedules | filter: filterString:strict)">
                        <div class="box card">
                            <div class="box-body">

                                <div>
                                    <label class="md-check pos-abt">
                                        <input type="checkbox" data-checklist-model="object.schedules" data-checklist-value="schedule"><i
                                            class="primary"></i></label>

                                    <div class="text-left m-l-md block-ellipsis" >
                                         <a href="#/schedule/{{schedule.name}}" uib-tooltip="{{schedule.title}}"  ng-bind="schedule.name"></a>
                                        <span class="fa fa-stop text-xs" ng-class="colorFunction(schedule.state.severity)"></span>
                                    </div>
                                    <div class="btn-group dropdown pull-right abt-dropdown ">
                                        <a href class=" more-option text-black-lt" data-toggle="dropdown"><i
                                                class="text fa fa-ellipsis-v"></i></a>

                                        <div class="dropdown-menu dropdown-ac dropdown-more">
                                            <a href="#/showConfiguration?type=schedule&path={{schedule.path}}/{{schedule.name}}" target="_blank" class="hide dropdown-item" ng-class="{show:permission.Schedule.view.configuration}">Show configuration</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-sm text-left text-muted p-t-sm">
                                    <span>Validity: </span>
                                    <span ng-bind="'-'"></span>
                                </div>
                                 <div class="text-sm text-left text-muted p-t-sm">
                                    <span>No. of orders: </span>
                                    <span class="text-dark" ng-bind="schedule.usedByOrders.length"></span>
                                </div>
                            </div>
                            <div class="box-footer b-t">
                                <div>
                                    <a href class="text-left" ng-click="substitute(schedule)"><i class="fa fa-repeat text-black-lt"></i> <span class="text-black-lt">Substitute</span></a>
                                    <a href class="pull-right" ng-click="editSchedule(schedule)"><i class="fa fa-pencil text-black-lt"></i> <span class="text-black-lt">Edit Schedule</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
             </div>
            <div class="box p-a" ng-show="pageView=='list'">
                <div class="table-responsive">
                    <table class="table table-hover table-bordered  ">
                        <thead>
                        <tr>
                            <th>
                                <label class="md-check">
                                    <input type="checkbox" ng-model="allCheck.checkbox" ng-click="checkAll()"><i class="primary"></i>
                                </label>
                            </th>
                            <th ng-click="sortBy('name')"><a>Schedule Name
                                <i ng-show="propertyName == 'name' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'name' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortBy('path')"><a>Path
                                <i ng-show="propertyName == 'path' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'path' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortBy('state._text')"><a>State
                                <i ng-show="propertyName == 'state._text' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'state._text' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortBy('usedByOrders.length')"><a>Used by Orders
                                <i ng-show="propertyName == 'usedByOrders.length' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'usedByOrders.length' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                              <th ng-click="sortBy('validityFrom')"><a>Validity from
                                <i ng-show="propertyName == 'validityFrom' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'validityFrom' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                              <th ng-click="sortBy('validityTo')"><a>Validity to
                                <i ng-show="propertyName == 'validityTo' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'validityTo' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                             <th ng-click="sortBy('subsituteBy')"><a>Subsitute by
                                <i ng-show="propertyName == 'subsituteBy' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'subsituteBy' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th ng-click="sortBy('nextStartTime')"><a>Next start
                                <i ng-show="propertyName == 'nextStartTime' && !reverse"
                                   class="fa fa-caret-down "></i>
                                <i ng-show="propertyName == 'nextStartTime' && reverse"
                                   class="fa fa-caret-up "></i></a>
                            </th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="schedule in filtered = (schedules | filter: filterString:strict) | startFrom:(currentPage - 1) * pageSize|limitTo: pageSize">
                            <td>
                                <label class="md-check">
                                    <input type="checkbox" data-checklist-model="object.schedules" data-checklist-value="schedule"><i class="primary"></i>
                                </label>
                            </td>
                            <td ><a href="#/schedule/{{schedule.name}}">{{schedule.name}}</a>
                                <span ng-if="schedule.title">-</span>
                                <i class="text-muted" ng-bind-html="schedule.title"></i>
                            </td>
                            <td ng-bind="schedule.path"></td>
                             <td><span class="text-c label" ng-class="bgColorFunction(schedule.state.severity)" ng-bind="schedule.state._text  | translate" ></span></td>
                            <td><a href="" ng-bind="schedule.usedByOrders.length"></a></td>
                            <td><a href="" ng-bind="schedule.validityFrom || '-'"></a></td>
                            <td><a href="" ng-bind="schedule.validityTo || '-'"></a></td>
                            <td><a href="" ng-bind="schedule.subsituteBy || '-'"></a></td>
                            <td><a href="" ng-bind="schedule.nextStart || '-'"></a></td>

                            <td>
                                <div class="btn-group dropdown">
                                <a class="more-option-h" href data-toggle="dropdown"><i class="fa fa-ellipsis-h"></i></a>
                                <div class="dropdown-menu dropdown-ac dropdown-more pull-left m-r-28" role="menu">
                                    <a href="#/showConfiguration?type=schedule&path={{schedule.path}}/{{schedule.name}}" target="_blank" class="hide dropdown-item" ng-class="{show:permission.Schedule.view.configuration}">Show configuration</a>
                                    <a class="dropdown-item" ng-click="substitute(schedule)">Substitute</a>
                                    <a class="dropdown-item" ng-click="editSchedule(schedule)">Edit schedule</a>
                                </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <ul ng-show="filtered.length > pageSize" uib-pagination total-items="filtered.length" ng-model="currentPage" items-per-page='pageSize' class="pagination-sm m-t-0" max-size="5" ng-change="pageChange()" boundary-link-numbers="true" rotate="false" previous-text="Prev"></ul>
                    <div class="pull-right" ng-show="filtered.length > 10">
                        <div class="btn-group m-r-xxs">
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'10'"
                                    ng-class="{'primary': pageSize=='10'}" >10
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'25'"
                                    ng-class="{'primary': pageSize=='25'}" >25
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'50'"
                                    ng-class="{'primary': pageSize=='50'}" >50
                            </button>
                            <button class="btn btn-default white btn-sm" ng-model="pageSize" uib-btn-radio="'100'"
                                    ng-class="{'primary': pageSize=='100'}">100
                            </button>
                        </div>
                    </div>
                </div>
            <div class="text-center m-t text-uppercase hide text-orange" ng-class="{'show': (filtered.length===0 && schedules.length !==0)}" translate>No data matched</div>
        </div>
        <div ng-if="isLoading && schedules.length==0" class="text-center m-t h6 text-uppercase">No Data Found</div>
    </div>
    <div ng-if="!isLoading" class="text-center m-t-lg"><div class="cssload-loading">Loading...</div></div>
</div>
</div>

<script>
    $('.table-responsive').on('shown.bs.dropdown', function (e) {
    var $table = $(this),
        $menu = $(e.target).find('.dropdown-menu'),
        tableOffsetHeight = $table.offset().top + $table.height(),
        menuOffsetHeight = $menu.offset().top + $menu.outerHeight(true);

    if (menuOffsetHeight > tableOffsetHeight)
      $table.css("padding-bottom", menuOffsetHeight - tableOffsetHeight +10);
  });

  $('.table-responsive').on('hide.bs.dropdown', function () {
    $(this).css("padding-bottom", 0);
  });
</script>
